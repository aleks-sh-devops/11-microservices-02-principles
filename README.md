# Домашнее задание к занятию «Микросервисы: принципы»

Вы работаете в крупной компании, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps-специалисту необходимо выдвинуть предложение по организации инфраструктуры для разработки и эксплуатации.

## Задача 1: API Gateway 

Предложите решение для обеспечения реализации API Gateway. Составьте сравнительную таблицу возможностей различных программных решений. На основе таблицы сделайте выбор решения.

Решение должно соответствовать следующим требованиям:
- маршрутизация запросов к нужному сервису на основе конфигурации,
- возможность проверки аутентификационной информации в запросах,
- обеспечение терминации HTTPS.

Обоснуйте свой выбор.

<table>
	<tr>
	    <th>Решение реализации API Gateway</th>
		<th>Маршрутизация запросов</th>
		<th>Проверка аутентификационной информации</th>
		<th>Терминация HTTPS</th>
	</tr >
	<tr >
	    <td>Amazon API Gateway</td>
		<td>+</td>
		<td>+</td>
		<td>+</td>
	</tr>
	<tr>
	    <td>Google Cloud Endpoints</td>
		<td>+</td>
		<td>+</td>
		<td>+</td>
	</tr>
	<tr>
	    <td>Kong Gateway</td>
		<td>+</td>
		<td>+</td>
		<td>+</td>
	</tr>
	<tr>
	    <td>Yandex API Gateway</td>
		<td>+</td>
		<td>+</td>
		<td>+</td>
	</tr>
	<tr>
	    <td>Oracle API Gateway</td>
		<td>+</td>
		<td>+</td>
		<td>+</td>
	</tr>
	<tr>
	    <td>Azure API Management</td>
		<td>+</td>
		<td>+</td>
		<td>+</td>
	</tr>
	<tr>
	    <td>NGINX</td>
		<td>+</td>
		<td>+</td>
		<td>+</td>
	</tr>
	<tr>
	    <td>HAProxy</td>
		<td>+</td>
		<td>+</td>
		<td>+</td>
	</tr>
</table>

Рассмотрев приведенные выше решения пришел к выводу о том, что все они удовлетворяют нашим требованиям. Поэтому если нужно выбирать, то я бы установил для себя дополнительные критерии. Это может быть текущая и будущая инфраструктура. Если вы работаете в облаке AWS, то использовать API GATEWAY от майкрософта или гугла будет весьма странно. Также критерием может выступать цена продукта. Например, Kong Gateway бесплатный, а Yandex API Gateway - нет.

## Задача 2: Брокер сообщений

Составьте таблицу возможностей различных брокеров сообщений. На основе таблицы сделайте обоснованный выбор решения.

Решение должно соответствовать следующим требованиям:
- поддержка кластеризации для обеспечения надёжности,
- хранение сообщений на диске в процессе доставки,
- высокая скорость работы,
- поддержка различных форматов сообщений,
- разделение прав доступа к различным потокам сообщений,
- простота эксплуатации.

Обоснуйте свой выбор.

<table>
	<tr>
	    <th>Брокеры</th>
		<th>Поддержка кластеризации</th>
		<th>Хранение сообщений на диске в процессе доставки</th>
		<th>Высокая скорость работы</th>
		<th>Поддержка различных форматов сообщений</th>
		<th>Разделение прав доступа к различным потокам сообщений</th>
		<th>Простота эксплуатации</th>
	</tr >
	<tr >
	    <td>RabbitMQ</td>
		<td>+</td>
		<td>+</td>
		<td>+-</td>
		<td>+</td>
		<td>+</td>
		<td>+</td>
	</tr>
	<tr>
	    <td>Kafka</td>
		<td>+</td>
		<td>+</td>
		<td>+</td>
		<td>+</td>
		<td>+</td>
		<td>+</td>
	</tr>
	<tr>
	    <td>AWS SQS</td>
		<td>+</td>
		<td>+</td>
		<td>+</td>
		<td>+</td>
		<td>+</td>
		<td>+</td>
	</tr>
	<tr>
	    <td>Redis</td>
		<td>+</td>
		<td>-</td>
		<td>++</td>
		<td>+</td>
		<td>+</td>
		<td>+</td>
	</tr>
</table>

По мне само понятие "лучшее решение" - серебряная пуля. Нужно смотреть исходя из задачи. Если смотреть на критерии, то Редис сразу выбывает из-за отсутствия хранения сообщений на диске в процессе доставки, несмотря на свое быстродействие. AWS хорош, но если ты используешь амазоновские мощности. И остается либо RabbitMQ либо Kafka. И тут у каждого решения есть свои плюсы и свои минусы. Поэтому в рамках поставленной задачи они оба подходят, но если говорить про конкретику, то когда искал ответ на поставленный вопрос мне помогли эти статьи:  
[раз](https://habr.com/ru/companies/yandex_praktikum/articles/700608/)  
[два](https://habr.com/ru/companies/itsumma/articles/416629/)  
